{
  "_json": [
    {
      "sorteo": 8,
      "numero": "10",
      "apuestas": [
        {
          "id_apuesta": 881413,
          "premio": "600000.00"
        }
      ]
    },
    {
      "sorteo": 16,
      "numero": "10",
      "apuestas": [
        {
          "id_apuesta": 881416,
          "premio": "600000.00"
        }
      ]
    },
    {
      "sorteo": 21,
      "numero": "10",
      "apuestas": [
        {
          "id_apuesta": 881415,
          "premio": "600000.00"
        }
      ]
    },
    {
      "sorteo": 93,
      "numero": "100",
      "apuestas": [
        {
          "id_apuesta": 881418,
          "premio": "14000000.00"
        },
        {
          "id_apuesta": 881418,
          "premio": "14000000.00"
        }
      ]
    }
  ],
  "award": {}
}

tickets_to_pay = bets_awards.pluck(:ticket_id).uniq.map{ |ticket_id|
  {
    ticket_id: ticket_id,
    premio: bets_awards.select{ |award|
      award[:ticket_id] == ticket_id
    }.inject(0) { |sum,hash| sum + hash[:amount].to_f }
  }
}

tickets = Bet.where(remote_bet_id: bets_awards.pluck(:id_apuesta))
